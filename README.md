## Задача 1: Парсинг данных с Avito

## Описание проекта

Парсер объявлений о недвижимости с сайта Avito, реализованный на Python. Собирает данные объявлений и сохраняет в структурированном XML-формате.

## Особенности реализации

### Технологический стек
- **Selenium WebDriver** - автоматизация браузера и обход анти-бот защиты
- **BeautifulSoup** - парсинг HTML-контента
- **WebDriver Manager** - автоматическое управление драйверами браузера
- **XML.etree.ElementTree** - сохранение данных в XML

### Ключевые функции
- Обход защиты Avito от парсинга
- Обнаружение и обработка капчи
- Случайные задержки между действиями
- Сохранение данных с разбивкой по файлам
- Подробное логирование процесса

### Собираемые данные
Для каждого объявления:
- Заголовок
- Цена
- Адрес
- Площадь (м²)
- Ссылка
- Дата публикации

## Установка и запуск

### Требования
- Python 3.8+
- Google Chrome
- Доступ в интернет

### Установка
```bash
pip install selenium webdriver-manager beautifulsoup4
```
### Запуск:
```bash
python src/exercise_1/avito.py "URL_страницы_Avito" [--max_ads N] [--batch_size 2000]
```
### Пример:
```bash
python src/exercise_1/avito.py "https://www.avito.ru/rostovskaya_oblast/kvartiry/prodam-ASgBAgICAUSSA8YQ?district=45" --max_ads 5000
```
## Капча
При обнаружении:
Решите капчу в браузере вручную
Нажмите Enter в консоли
Альтернативно: смените IP или подождите 10-15 мин
Оптимизация
Задержки ≥5 сек между запросами
Ограничьте объявления (20-30/запуск)
Парсите ночью (меньше нагрузка)

## Задача 2: Веб-интерфейс для работы с XML

### Описание
Веб-приложение для загрузки и обработки XML-файлов с объявлениями, полученными из парсера Avito.

### Технологии
- **Backend**: FastAPI (Python)
- **Frontend**: HTML/CSS/JavaScript
- **Дополнительно**:
  - Pydantic для валидации
  - lxml для обработки XML

### Запуск сервера
```bash
uvicorn src.exercise_2.backend.main:app --reload
```
## Функционал
Backend (FastAPI)
POST /upload - загрузка XML файла
- **Проверка на дубликаты**
- Валидация структуры




### Задача 4: Легаси-код
### Проблемы в предоставленном PHP-коде:
### Безопасность:
 - Нет проверки валидности входного файла
 - Уязвимость к XXE-атакам (внешним entity)
 - Риск SQL-инъекций при сохранении в БД
### Надежность:
 - Отсутствует обработка ошибок парсинга XML
 - Нет транзакционной целостности при работе с БД
 - Нет проверки дубликатов объявлений
### Производительность:
 - Загрузка всего XML-файла в память
 - Поштучная вставка в БД вместо batch-обработки
 - Нет ограничений на размер обрабатываемого файла
### Архитектура:
 - Жесткая связность кода
 - Отсутствие валидации данных
 - Нет логгирования ошибок
## Модификация для Python-скрипта:
## Безопасная загрузка XML:
 - Использование lxml.etree.iterparse для потокового чтения
 - Отключение обработки внешних entity
 - Валидация структуры XML 
### Оптимизация работы с БД:
 - Пакетная вставка (bulk insert)
 - Использование UNIQUE-ограничений для избежания дубликатов
 - Транзакционная обработка

### Решение для 10k+ объявлений:
 - Потоковая обработка:
 - Чтение XML порциями через итераторы
 - Очистка памяти от обработанных элементов
 - Оптимизация БД:
 - Временное отключение индексов во время загрузки
 - Использование COPY (PostgreSQL) или bulk_insert (SQLAlchemy)
 - Параллельная запись через несколько соединений
### Дополнительные меры:
 - Распределенная обработка через Celery/RQ


Ключевые технологии для реализации:

Для парсинга: lxml или xml.etree.ElementTree

Для БД: asyncpg (PostgreSQL) или aiosqlite

Для параллельной обработки: asyncio + aiohttp (если есть сетевые запросы)

Для кеширования: Redis